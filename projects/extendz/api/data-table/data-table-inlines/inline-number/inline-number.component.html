<span
  fxLayout="row"
  [fxLayoutAlign]="property?.inlineEdit?.fxLayoutAlign || 'start center'"
  (mouseenter)="property?.inlineEdit?.enabled && (edit = true)"
  (mouseleave)="edit = false"
>
  <p>{{ control?.value }}</p>
  <span #trigger="cdkOverlayOrigin" cdkOverlayOrigin>
    <button
      *ngIf="edit || this.property?.inlineEdit?.showAlways"
      class="fade-in-fwd"
      [disabled]="control.disabled"
      mat-icon-button
      (click)="isPopoverOpen = !isPopoverOpen"
    >
      <ng-container [ngTemplateOutlet]="i_save_edit"></ng-container>
    </button>
  </span>
  <span fxFlex="1"></span>
</span>

<ng-template
  cdkConnectedOverlay
  cdkConnectedOverlayPanelClass="custom-popover"
  [cdkConnectedOverlayHasBackdrop]="true"
  [cdkConnectedOverlayOpen]="isPopoverOpen"
  [cdkConnectedOverlayOrigin]="trigger"
  (backdropClick)="isPopoverOpen = false"
>
  <mat-card>
    <mat-form-field>
      <input type="number" autofocus matInput [formControl]="control" />
    </mat-form-field>
    <mat-card-actions>
      <span fxFlex></span>
      <button mat-button (click)="isPopoverOpen = !isPopoverOpen">Cancel</button>
      <button
        mat-raised-button
        color="primary"
        type="button"
        (click)="isPopoverOpen = !isPopoverOpen; emit()"
      >
        Apply
      </button>
    </mat-card-actions>
  </mat-card>
</ng-template>

<ng-template #i_save_edit>
  <mat-icon>
    <svg viewBox="0 0 24 24">
      <path
        fill="currentColor"
        d="M4 19H10V21H4C2.89 21 2 20.1 2 19V5C2 3.9 2.89 3 4 3H16L20 7V9.12L18 11.12V7.83L15.17 5H4V19M14 10V6H5V10H14M20.42 12.3C20.31 12.19 20.18 12.13 20.04 12.13C19.9 12.13 19.76 12.19 19.65 12.3L18.65 13.3L20.7 15.35L21.7 14.35C21.92 14.14 21.92 13.79 21.7 13.58L20.42 12.3M12 19.94V22H14.06L20.12 15.93L18.07 13.88L12 19.94M14 15C14 13.34 12.66 12 11 12S8 13.34 8 15 9.34 18 11 18C11.04 18 11.08 18 11.13 18L14 15.13C14 15.09 14 15.05 14 15"
      />
    </svg>
  </mat-icon>
</ng-template>
